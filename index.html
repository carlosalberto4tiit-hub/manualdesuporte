<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat de Suporte Meu Pabx Cloud</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #1a252f;
            --accent: #3498db;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --gray: #95a5a6;
            --bot-bg: #dfe6e9;
            --user-bg: #3498db;
            --user-text: white;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a252f, #2c3e50);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            display: flex;
            gap: 30px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            height: 90vh;
        }
        
        .config-panel {
            width: 350px;
            background: var(--dark);
            color: white;
            padding: 25px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
            transition: all 0.3s ease;
        }
        
        .config-panel.hidden {
            width: 0;
            padding: 0;
            overflow: hidden;
            border-right: none;
        }
        
        .config-header {
            display: flex;
            align-items: center;
            gap: 15px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .config-header i {
            font-size: 28px;
            color: var(--accent);
        }
        
        .config-header h2 {
            font-weight: 600;
            font-size: 24px;
        }
        
        .config-section {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 18px;
        }
        
        .config-section h3 {
            margin-bottom: 15px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .config-section h3 i {
            color: var(--accent);
        }
        
        .config-content {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        textarea {
            width: 100%;
            height: 200px;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            color: white;
            font-family: monospace;
            resize: vertical;
            outline: none;
        }
        
        textarea:focus {
            border-color: var(--accent);
        }
        
        .btn {
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: var(--success);
        }
        
        .btn-success:hover {
            background: #27ae60;
        }
        
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: white;
        }
        
        .chat-header {
            background: var(--primary);
            color: white;
            padding: 20px 30px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .chat-header i {
            font-size: 24px;
        }
        
        .chat-header h1 {
            font-weight: 600;
            font-size: 22px;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
            background: #f8f9fa;
        }
        
        .message {
            max-width: 85%;
            padding: 15px 20px;
            border-radius: 18px;
            animation: fadeIn 0.4s ease;
            position: relative;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
            line-height: 1.5;
        }
        
        .bot-message {
            align-self: flex-start;
            background: var(--bot-bg);
            border-bottom-left-radius: 5px;
        }
        
        .user-message {
            align-self: flex-end;
            background: var(--user-bg);
            color: var(--user-text);
            border-bottom-right-radius: 5px;
        }
        
        .options-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            padding: 15px;
            background: white;
            border-top: 1px solid #e9ecef;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .option-btn {
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 10px 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }
        
        .option-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        .option-btn i {
            font-size: 14px;
        }
        
        .input-container {
            display: flex;
            padding: 15px;
            background: white;
            border-top: 1px solid #e9ecef;
        }
        
        .input-container input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #e9ecef;
            border-radius: 30px;
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .input-container input:focus {
            border-color: var(--accent);
        }
        
        .input-container button {
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            margin-left: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .input-container button:hover {
            background: #2980b9;
            transform: scale(1.05);
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .typing-indicator {
            display: inline-block;
            background: var(--bot-bg);
            padding: 12px 20px;
            border-radius: 18px;
            border-bottom-left-radius: 5px;
        }
        
        .typing-indicator span {
            height: 8px;
            width: 8px;
            float: left;
            margin: 0 2px;
            background-color: #6c757d;
            display: block;
            border-radius: 50%;
            opacity: 0.4;
        }
        
        .typing-indicator span:nth-of-type(1) {
            animation: typing 1s infinite;
        }
        
        .typing-indicator span:nth-of-type(2) {
            animation: typing 1s infinite 0.2s;
        }
        
        .typing-indicator span:nth-of-type(3) {
            animation: typing 1s infinite 0.4s;
        }
        
        @keyframes typing {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-5px); opacity: 0.8; }
            100% { transform: translateY(0px); opacity: 0.4; }
        }
        
        .menu-path {
            font-size: 14px;
            color: #6c757d;
            margin-top: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .menu-path i {
            font-size: 12px;
        }
        
        .info-panel {
            background: #e7f5ff;
            border-radius: 12px;
            padding: 18px;
            margin-top: 20px;
            border-left: 4px solid var(--accent);
        }
        
        .info-panel h4 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .info-panel p {
            font-size: 14px;
            color: #495057;
            line-height: 1.6;
        }
        
        .info-panel code {
            background: rgba(0, 0, 0, 0.05);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }
        
        .history-item {
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
        }
        
        .history-item:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .code-info {
            background-color: #f0f8ff;
            border-radius: 10px;
            padding: 15px;
            border-left: 4px solid var(--accent);
            margin-top: 10px;
        }
        
        .code-header {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 8px;
            color: var(--dark);
        }
        
        .code-description {
            margin-bottom: 10px;
        }
        
        .code-example {
            background: rgba(0, 0, 0, 0.05);
            padding: 8px 12px;
            border-radius: 6px;
            font-family: monospace;
            margin-top: 8px;
            font-size: 14px;
        }
        
        .image-container {
            max-width: 100%;
            margin-top: 15px;
            text-align: center;
        }
        
        .image-container img {
            max-width: 100%;
            border-radius: 10px;
            border: 1px solid #eee;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .image-caption {
            font-size: 13px;
            color: #6c757d;
            margin-top: 5px;
            font-style: italic;
        }
        
        .back-btn {
            background: #95a5a6;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 8px 16px;
            cursor: pointer;
            margin-top: 15px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .back-btn:hover {
            background: #7f8c8d;
        }
        
        .info-message {
            background: #e1f5fe;
            border-radius: 10px;
            padding: 15px;
            border-left: 4px solid #039be5;
            margin-top: 10px;
        }
        
        .toggle-panel-btn {
            position: absolute;
            left: 10px;
            top: 10px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .toggle-panel-btn.hidden {
            display: none;
        }
        
        .toggle-panel-btn:hover {
            background: #2980b9;
        }
    </style>
</head>
<body>
    <button class="toggle-panel-btn" id="toggle-panel-btn" title="Mostrar/Ocultar painel de configura√ß√£o">
        <i class="fas fa-cogs"></i>
    </button>
    
    <div class="container">
        <div class="config-panel" id="config-panel">
            <div class="config-header">
                <i class="fas fa-cogs"></i>
                <h2>Configura√ß√£o do Chat</h2>
            </div>
            
            <div class="config-section">
                <h3><i class="fas fa-file-code"></i> Carregar Configura√ß√£o</h3>
                <div class="config-content">
                    <textarea id="config-text" placeholder='Cole sua configura√ß√£o JSON aqui...'></textarea>
                    <button id="load-btn" class="btn">
                        <i class="fas fa-sync-alt"></i> Carregar Configura√ß√£o
                    </button>
                </div>
            </div>
            
            <div class="config-section">
                <h3><i class="fas fa-history"></i> Hist√≥rico de Configura√ß√µes</h3>
                <div class="config-content">
                    <div class="history-item" onclick="loadSampleConfig('default')">Configura√ß√£o Padr√£o</div>
                    <div class="history-item" onclick="loadSampleConfig('suporte')">Suporte T√©cnico</div>
                    <div class="history-item" onclick="loadSampleConfig('vendas')">Vendas</div>
                </div>
            </div>
            
            <div class="info-panel">
                <h4><i class="fas fa-lightbulb"></i> Como usar</h4>
                <p>1. Defina sua configura√ß√£o em JSON no campo acima</p>
                <p>2. Clique em "Carregar Configura√ß√£o"</p>
                <p>3. Interaja com o chat usando os bot√µes ou digitando</p>
                <p>Use <code>"proximo": "nome_menu"</code> para definir os fluxos</p>
            </div>
            
            <button class="btn btn-success">
                <i class="fas fa-save"></i> Salvar Configura√ß√£o
            </button>
        </div>
        
        <div class="chat-container">
            <div class="chat-header">
                <i class="fas fa-comments"></i>
                <h1>Meu Pabx Cloud - Suporte</h1>
            </div>
            
            <div class="chat-messages" id="chat-messages">
                <div class="message bot-message">
                    Ol√°! Sou o assistente virtual do Meu Pabx Cloud. Por favor, carregue uma configura√ß√£o para come√ßar.
                    <div class="menu-path">
                        <i class="fas fa-map-marker-alt"></i> Aguardando configura√ß√£o
                    </div>
                </div>
            </div>
            
            <div class="options-container" id="options-container">
                </div>
            
            <div class="input-container">
                <input type="text" id="user-input" placeholder="Escreva sua mensagem...">
                <button id="send-btn">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Configura√ß√£o completa traduzida para portugu√™s (TODAS as op√ß√µes mantidas)
        const chatConfig = {
            "menuInicial": {
                "mensagem": "Bem-vindo ao Assistente Meu Pabx Cloud! Como posso ajudar?",
                "opcoes": [
                    {"texto": "üì± Introdu√ß√£o ao Meu Pabx Cloud", "proximo": "introducao"},
                    {"texto": "üîë Fazer Login", "proximo": "login"},
                    {"texto": "üìû Chamadas e Mensagens", "proximo": "chamadas_mensagens"},
                    {"texto": "üë• Gerenciar Filas", "proximo": "gerenciar_filas"},
                    {"texto": "üì≤ Configurar Caller ID", "proximo": "callerid"},
                    {"texto": "üí¨ SMS e WhatsApp", "proximo": "sms_whatsapp"},
                    {"texto": "üñ•Ô∏è Softphone", "proximo": "softphone"},
                    {"texto": "üî¢ C√≥digos de Fun√ß√£o", "proximo": "codigos_funcao"},
                    {"texto": "üÜò Suporte T√©cnico", "proximo": "suporte"}
                ]
            },
            "introducao": {
                "mensagem": "O Meu Pabx Cloud √© a solu√ß√£o completa para as comunica√ß√µes empresariais. Compat√≠vel apenas com o PABX Meu Pabx Cloud v22+. Principais funcionalidades:\n\n- Chamadas de voz/v√≠deo\n- Mensagens instant√¢neas\n- Caixa postal\n- Reuni√µes\n- Integra√ß√£o SMS/WhatsApp",
                "opcoes": [
                    {"texto": "‚¨áÔ∏è Baixar Aplicativo", "proximo": "download"},
                    {"texto": "üì± Ver Telas do App", "proximo": "telas_app"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "menuInicial"}
                ]
            },
            "telas_app": {
                "mensagem": "Vis√£o geral das principais telas do aplicativo:",
                "opcoes": [
                    {"texto": "üí¨ Chat/Mensagens", "proximo": "imagem:portsip-one-mobile-8.png"},
                    {"texto": "üìû Hist√≥rico de Chamadas", "proximo": "imagem:portsip-one-mobile-9.png"},
                    {"texto": "üë• Contatos", "proximo": "imagem:portsip-one-mobile-10.png"},
                    {"texto": "üî¢ Teclado", "proximo": "imagem:portsip-one-mobile-11.png"},
                    {"texto": "üìÖ Reuni√µes", "proximo": "imagem:portsip-one-mobile-13.png"},
                    {"texto": "‚ö° Menu R√°pido", "proximo": "imagem:portsip-one-mobile-15.png"},
                    {"texto": "‚öôÔ∏è Configura√ß√µes", "proximo": "imagem:portsip-one-mobile-16.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "introducao"}
                ]
            },
            "download": {
                "mensagem": "Dispon√≠vel para todas as plataformas:",
                "opcoes": [
                    {"texto": "üíª Windows Desktop", "proximo": "url:https://meupabxcloud.com/download"},
                    {"texto": "üçé iOS (App Store)", "proximo": "url:https://apps.apple.com/br/app/meu-pabx-cloud/id6740400840"},
                    {"texto": "ü§ñ Android (Google Play)", "proximo": "url:https://play.google.com/store/apps/details?id=mobilecontrol.android.app.meupabxcloud"},
                    {"texto": "üåê WebRTC (Navegador)", "proximo": "url:https://meu-pabx-cloud.com:10443/"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "introducao"}
                ]
            },
            "login": {
                "mensagem": "M√©todos de login dispon√≠veis:",
                "opcoes": [
                    {"texto": "üîí Login com QR Code", "proximo": "login_qr"},
                    {"texto": "‚å®Ô∏è Login Manual", "proximo": "login_manual"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "menuInicial"}
                ]
            },
            "login_qr": {
                "mensagem": "Procedimento para login com QR Code:\n\n1. Acesse o portal do PABX Meu Pabx Cloud\n2. V√° para Gerenciador de Chamadas > Usu√°rios\n3. Clique no usu√°rio e gere o QR Code\n4. No aplicativo m√≥vel, toque no √≠cone da c√¢mera\n5. Escaneie o c√≥digo",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Ver Exemplo de QR Code", "proximo": "imagem:user_qr1.png"},
                    {"texto": "‚ùì Problemas com QR Code", "proximo": "suporte_qr"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "login"}
                ]
            },
            "login_manual": {
                "mensagem": "Login manual:\n\n1. Insira o dom√≠nio SIP (ex: suaempresa.io)\n2. Insira o endere√ßo do PABX (IP ou dom√≠nio)\n3. Insira nome de usu√°rio e senha\n4. Clique em Acessar",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Exemplo: Inserir Servidor", "proximo": "imagem:portsip-one-mobile-6.png"},
                    {"texto": "üëÅÔ∏è Exemplo: Inserir Credenciais", "proximo": "imagem:portsip-one-mobile-7.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "login"}
                ]
            },
            "chamadas_mensagens": {
                "mensagem": "Funcionalidades de chamadas e mensagens:",
                "opcoes": [
                    {"texto": "üìû Fazer Chamadas", "proximo": "fazer_chamadas"},
                    {"texto": "üîÑ Transferir Chamadas", "proximo": "transferir_chamadas"},
                    {"texto": "‚èØÔ∏è Chamada em Espera", "proximo": "chamada_espera"},
                    {"texto": "üÖøÔ∏è Estacionar Chamada", "proximo": "estacionar_chamada"},
                    {"texto": "üì© Caixa Postal", "proximo": "correio_voz"},
                    {"texto": "üë• Mensagens de Equipe", "proximo": "mensagens_equipe"},
                    {"texto": "üìá Contatos", "proximo": "contatos"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "menuInicial"}
                ]
            },
            "fazer_chamadas": {
                "mensagem": "Como fazer chamadas:\n\n1. Pelo teclado: Digite o n√∫mero e clique em chamar\n2. Pelo contato: Acesse os contatos e clique no √≠cone de chamada\n3. Pelo hist√≥rico: Clique em uma chamada recente para ligar de volta\n4. Pela conversa: Em uma conversa, clique no √≠cone de chamada",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Exemplo: Teclado", "proximo": "imagem:portsip-one-mobile-11.png"},
                    {"texto": "üëÅÔ∏è Exemplo: Chamada pelo Contato", "proximo": "imagem:portsip-one-mobile-17.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "chamadas_mensagens"}
                ]
            },
            "transferir_chamadas": {
                "mensagem": "Tipos de transfer√™ncia:\n\n1. Cega: Transfere diretamente sem consulta\n2. Assistida: Consulta antes de transferir\n3. Para a Caixa Postal: Transfere diretamente para a caixa postal",
                "opcoes": [
                    {"texto": "üîÑ Transfer√™ncia Cega", "proximo": "imagem:portsip-one-mobile-18.png"},
                    {"texto": "üîÑ Transfer√™ncia Assistida", "proximo": "imagem:portsip-one-mobile-19.png"},
                    {"texto": "üì© Para a Caixa Postal", "proximo": "transferir_voicemail"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "chamadas_mensagens"}
                ]
            },
            "transferir_voicemail": {
                "mensagem": "Transferir para a caixa postal:\n\n1. Durante uma chamada, toque em Transferir\n2. Selecione 'Transferir para a Caixa Postal'\n3. Escolha o contato\n4. A chamada ser√° transferida diretamente para a caixa postal",
                "opcoes": [
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "transferir_chamadas"}
                ]
            },
            "chamada_espera": {
                "mensagem": "Colocar chamada em espera:\n\n1. Durante uma chamada, toque em 'Espera'\n2. O cliente ouvir√° m√∫sica de espera\n3. Toque novamente para retomar",
                "opcoes": [
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "chamadas_mensagens"}
                ]
            },
            "estacionar_chamada": {
                "mensagem": "Estacionar chamada:\n\n1. Direto: Para um colega espec√≠fico\n2. Grupo: Para um grupo de atendimento\n\nDurante a chamada:\n1. Toque em Transferir\n2. Selecione 'Estacionar' ou 'Estacionar em Grupo'",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Estacionamento Direto", "proximo": "imagem:portsip-one-mobile-20.png"},
                    {"texto": "üëÅÔ∏è Estacionamento em Grupo", "proximo": "imagem:portsip-one-mobile-21.png"},
                    {"texto": "üëÅÔ∏è Recuperar Chamada", "proximo": "imagem:portsip-one-mobile-22.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "chamadas_mensagens"}
                ]
            },
            "correio_voz": {
                "mensagem": "Acessar a caixa postal:\n\n1. Abra a aba Mensagens\n2. Selecione 'Caixa Postal'\n3. Toque na mensagem para ouvir",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Exemplo: Caixa Postal", "proximo": "imagem:portsip-one-mobile-23.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "chamadas_mensagens"}
                ]
            },
            "mensagens_equipe": {
                "mensagem": "Mensagens de equipe:\n\n- Conversas individuais\n- Grupos de mensagens\n- Compartilhamento de arquivos",
                "opcoes": [
                    {"texto": "üì§ Enviar Mensagem", "proximo": "enviar_mensagem"},
                    {"texto": "üë• Criar Grupo", "proximo": "criar_grupo"},
                    {"texto": "üëÅÔ∏è Exemplo: Mensagens", "proximo": "imagem:portsip-one-mobile-28.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "chamadas_mensagens"}
                ]
            },
            "enviar_mensagem": {
                "mensagem": "Enviar mensagem:\n\n1. Pelo contato: Acesse o contato e toque no √≠cone de mensagem\n2. Pelo menu: Na aba Mensagens, toque em '+' e selecione 'Criar mensagem'",
                "opcoes": [
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "mensagens_equipe"}
                ]
            },
            "criar_grupo": {
                "mensagem": "Criar grupo de mensagens:\n\n1. Na aba Mensagens, toque em '+'\n2. Selecione 'Criar grupo'\n3. D√™ um nome ao grupo\n4. Adicione membros\n5. Toque em Criar",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Exemplo: Criar Grupo", "proximo": "imagem:portsip-one-mobile-29.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "mensagens_equipe"}
                ]
            },
            "contatos": {
                "mensagem": "Gerenciar contatos:",
                "opcoes": [
                    {"texto": "‚ûï Adicionar Contato", "proximo": "adicionar_contato"},
                    {"texto": "‚≠ê Adicionar Favorito", "proximo": "adicionar_favorito"},
                    {"texto": "üëÅÔ∏è Exemplo: Contatos", "proximo": "imagem:portsip-one-mobile-24.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "chamadas_mensagens"}
                ]
            },
            "adicionar_contato": {
                "mensagem": "Adicionar contato:\n\n1. Abra a aba Contatos\n2. Toque em '+' no topo\n3. Preencha as informa√ß√µes\n4. Escolha 'Empresa' ou 'Pessoal'\n5. Toque em Salvar",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Exemplo: Adicionar", "proximo": "imagem:portsip-one-mobile-25.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "contatos"}
                ]
            },
            "adicionar_favorito": {
                "mensagem": "Adicionar favorito:\n\n1. Abra os detalhes do contato\n2. Toque na estrela no topo\n3. A estrela ficar√° amarela\n\nPara remover: Toque na estrela novamente",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Exemplo: Favoritos", "proximo": "imagem:portsip-one-mobile-26.png"},
                    {"texto": "üëÅÔ∏è Exemplo: Favorito Adicionado", "proximo": "imagem:portsip-one-mobile-27.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "contatos"}
                ]
            },
            "gerenciar_filas": {
                "mensagem": "Gerenciamento de filas de chamada:",
                "opcoes": [
                    {"texto": "üîÑ Mudar Status", "proximo": "mudar_status"},
                    {"texto": "üîå Entrar/Sair das Filas", "proximo": "entrar_sair_filas"},
                    {"texto": "üëÅÔ∏è Exemplo: √çcone de Filas", "proximo": "imagem:portsip-one-mobile-28.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "menuInicial"}
                ]
            },
            "mudar_status": {
                "mensagem": "Mudar status na fila:\n\n1. Toque no √≠cone de filas (no topo)\n2. Selecione o novo status\n3. O status ser√° aplicado a todas as filas",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Exemplo: Status Dispon√≠veis", "proximo": "imagem:portsip-one-mobile-30.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "gerenciar_filas"}
                ]
            },
            "entrar_sair_filas": {
                "mensagem": "Entrar/sair das filas:\n\n1. Toque no √≠cone de filas\n2. Na lista de filas, ative/desative o interruptor\n3. O status ser√° aplicado apenas para a fila selecionada",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Exemplo: Lista de Filas", "proximo": "imagem:portsip-one-mobile-29.png"},
                    {"texto": "üëÅÔ∏è Exemplo: Filas Ativas", "proximo": "imagem:portsip-one-mobile-29.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "gerenciar_filas"}
                ]
            },
            "callerid": {
                "mensagem": "Personalizar Caller ID:",
                "opcoes": [
                    {"texto": "üÜî Configurar Caller ID", "proximo": "config_callerid"},
                    {"texto": "üö´ Ocultar N√∫mero", "proximo": "ocultar_numero"},
                    {"texto": "ü§ñ Usar Padr√£o do PABX", "proximo": "padrao_pbx"},
                    {"texto": "üëÅÔ∏è Exemplo: Teclado", "proximo": "imagem:portsip-one-mobile-30.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "menuInicial"}
                ]
            },
            "config_callerid": {
                "mensagem": "Configurar Caller ID:\n\n1. No teclado, toque em 'Chamar como'\n2. Selecione o n√∫mero desejado\n3. Chame normalmente",
                "opcoes": [
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "callerid"}
                ]
            },
            "ocultar_numero": {
                "mensagem": "Ocultar n√∫mero:\n\n1. No teclado, toque em 'Chamar como'\n2. Selecione 'Ocultar n√∫mero'\n3. Digite o n√∫mero",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Exemplo: Ocultar N√∫mero", "proximo": "imagem:portsip-one-mobile-31.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "callerid"}
                ]
            },
            "padrao_pbx": {
                "mensagem": "Usar padr√£o do PABX:\n\n1. No teclado, toque em 'Chamar como'\n2. Selecione 'Caller ID do servidor'\n3. O PABX determinar√° automaticamente o Caller ID",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Exemplo: Padr√£o do PABX", "proximo": "imagem:portsip-one-mobile-32.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "callerid"}
                ]
            },
            "sms_whatsapp": {
                "mensagem": "Mensagens SMS e WhatsApp:",
                "opcoes": [
                    {"texto": "üì® Configurar SMS", "proximo": "config_sms"},
                    {"texto": "üíö Configurar WhatsApp", "proximo": "config_whatsapp"},
                    {"texto": "üí¨ Usar SMS/WhatsApp", "proximo": "usar_sms_whatsapp"},
                    {"texto": "üëÅÔ∏è Exemplo: Mensagens", "proximo": "imagem:portsip-one-mobile-28.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "menuInicial"}
                ]
            },
            "config_sms": {
                "mensagem": "Configurar SMS:\n\n1. O administrador deve configurar um provedor de tronco compat√≠vel\n2. Lista de provedores suportados:\n   - Twilio\n   - Vonage\n   - Bandwidth\n   - ... (veja a lista completa no manual)",
                "opcoes": [
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "sms_whatsapp"}
                ]
            },
            "config_whatsapp": {
                "mensagem": "Configurar WhatsApp:\n\n1. O administrador deve integrar com a API do WhatsApp Business\n2. Configurar fluxos de atendimento\n3. Atribuir aos agentes",
                "opcoes": [
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "sms_whatsapp"}
                ]
            },
            "usar_sms_whatsapp": {
                "mensagem": "Usar SMS/WhatsApp:\n\n1. Abra a aba Mensagens\n2. Selecione SMS ou WhatsApp\n3. Toque em '+' para uma nova conversa\n4. Selecione contato ou n√∫mero\n5. Envie mensagens, arquivos, localiza√ß√£o",
                "opcoes": [
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "sms_whatsapp"}
                ]
            },
            "softphone": {
                "mensagem": "Configura√ß√µes do Softphone:",
                "opcoes": [
                    {"texto": "üì± Registrar via QR Code", "proximo": "softphone_qr"},
                    {"texto": "‚å®Ô∏è Registrar Manualmente", "proximo": "softphone_manual"},
                    {"texto": "üîå Configurar Proxy", "proximo": "config_proxy"},
                    {"texto": "üëÅÔ∏è Exemplo: Desktop", "proximo": "imagem:portsip_desktop1.png"},
                    {"texto": "üëÅÔ∏è Exemplo: Mobile", "proximo": "imagem:portsip_iphone_1.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "menuInicial"}
                ]
            },
            "softphone_qr": {
                "mensagem": "Registrar via QR Code:\n\n1. No portal Meu Pabx Cloud, gere o QR Code do usu√°rio\n2. No softphone, selecione a op√ß√£o para escanear\n3. Aponte a c√¢mera para o QR Code\n4. O registro ocorrer√° automaticamente",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Exemplo: QR Code", "proximo": "imagem:user_qr1.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "softphone"}
                ]
            },
            "softphone_manual": {
                "mensagem": "Registro manual:\n\n- Nome de usu√°rio: ramal\n- Senha: senha do ramal\n- Dom√≠nio: dom√≠nio SIP do tenant\n- Servidor Proxy: IP p√∫blico/privado do PABX\n- Porta: conforme transporte (ex: 5060 para UDP)\n- Transporte: UDP, TCP, TLS, WSS",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Exemplo: Configura√ß√µes", "proximo": "imagem:portsip_desktop2.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "softphone"}
                ]
            },
            "config_proxy": {
                "mensagem": "Configurar Proxy:\n\n- Para internet: use IP p√∫blico ou dom√≠nio\n- Para LAN: use IP privado\n- Porta: depende do transporte (ex: 5063 para TCP)\n\nImportante: N√£o defina a porta para o dom√≠nio SIP",
                "opcoes": [
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "softphone"}
                ]
            },
            "codigos_funcao": {
                "mensagem": "C√≥digos de Acesso a Funcionalidades (\"C√≥digos Estrela\"):",
                "opcoes": [
                    {"texto": "üîÑ Encaminhamento de Chamadas", "proximo": "encaminhamento_chamadas"},
                    {"texto": "‚èØÔ∏è Chamada em Espera/Retomada", "proximo": "espera_recuperacao"},
                    {"texto": "üìû Identifica√ß√£o de Chamadas", "proximo": "identificacao_chamadas"},
                    {"texto": "‚è∫Ô∏è Grava√ß√£o de Chamadas", "proximo": "gravacao_chamadas"},
                    {"texto": "üì≤ Transfer√™ncia de Chamadas", "proximo": "transferencia_chamadas"},
                    {"texto": "üì© Caixa Postal", "proximo": "correio_voz_codigos"},
                    {"texto": "üëÇ Monitoramento", "proximo": "monitoramento"},
                    {"texto": "üîï N√£o Perturbe", "proximo": "nao_perturbe"},
                    {"texto": "üìû Discagem R√°pida", "proximo": "chamada_rapida"},
                    {"texto": "üë§ Chamadas An√¥nimas", "proximo": "chamadas_anonimas"},
                    {"texto": "üìû Ponte/Retorno de Chamada", "proximo": "ponte_richiamata"},
                    {"texto": "üë• Agentes de Fila", "proximo": "agentes_fila"},
                    {"texto": "üíº Hot Desking", "proximo": "hot_desking"},
                    {"texto": "üîÑ Outras Fun√ß√µes", "proximo": "outras_funcoes"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "menuInicial"}
                ]
            },
            "encaminhamento_chamadas": {
                "mensagem": "C√≥digos de Encaminhamento de Chamadas:",
                "opcoes": [
                    {"texto": "*72 - Encaminhar Sempre Ativo", "proximo": "info:*72|Encaminha todas as chamadas para outro n√∫mero|Ex: *7212345678#"},
                    {"texto": "*73 - Desativar Encaminhar Sempre", "proximo": "info:*73|Desabilita o encaminhamento de chamadas sempre ativo"},
                    {"texto": "*90 - Encaminhar se Ocupado", "proximo": "info:*90|Encaminha quando ocupado|Ex: *9012345678"},
                    {"texto": "*92 - Encaminhar se N√£o Atender", "proximo": "info:*92|Encaminha quando n√£o atende|Ex: *9212345678#"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "codigos_funcao"}
                ]
            },
            "espera_recuperacao": {
                "mensagem": "C√≥digos de Espera e Retomada:",
                "opcoes": [
                    {"texto": "*68 - Estacionar Chamada", "proximo": "info:*68|Estaciona uma chamada|Ex: Transferir para *68"},
                    {"texto": "*58 - Estacionar em Grupo", "proximo": "info:*58|Estaciona em um grupo|Ex: Transferir para *58#"},
                    {"texto": "*88 - Recuperar Chamada", "proximo": "info:*88|Recupera chamada estacionada|Ex: *88#"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "codigos_funcao"}
                ]
            },
            "identificacao_chamadas": {
                "mensagem": "C√≥digos de ID de Chamada:",
                "opcoes": [
                    {"texto": "*31 - Ocultar ID Sempre", "proximo": "info:*31|Oculta sempre o ID de chamada"},
                    {"texto": "*65 - Mostrar ID por Chamada", "proximo": "info:*65|Mostra o ID por chamada|Ex: *6512345678"},
                    {"texto": "*67 - Ocultar ID por Chamada", "proximo": "info:*67|Oculta o ID por chamada|Ex: *6712345678"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "codigos_funcao"}
                ]
            },
            "gravacao_chamadas": {
                "mensagem": "C√≥digos de Grava√ß√£o:",
                "opcoes": [
                    {"texto": "*44 - Iniciar Grava√ß√£o", "proximo": "info:*44|Inicia a grava√ß√£o da chamada"},
                    {"texto": "*45 - Parar Grava√ß√£o", "proximo": "info:*45|Interrompe a grava√ß√£o"},
                    {"texto": "*48 - Pausar Grava√ß√£o", "proximo": "info:*48|Pausa a grava√ß√£o"},
                    {"texto": "*49 - Retomar Grava√ß√£o", "proximo": "info:*49|Retoma a grava√ß√£o"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "codigos_funcao"}
                ]
            },
            "transferencia_chamadas": {
                "mensagem": "C√≥digos de Transfer√™ncia:",
                "opcoes": [
                    {"texto": "*54 - Transferir Chamada", "proximo": "info:*54|Transfere a chamada|Ex: *54123456#"},
                    {"texto": "*55 - Transferir para Caixa Postal", "proximo": "info:*55|Transfere para a caixa postal|Ex: *55103"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "codigos_funcao"}
                ]
            },
            "correio_voz_codigos": {
                "mensagem": "C√≥digos de Caixa Postal:",
                "opcoes": [
                    {"texto": "*56 - Caixa Postal Compartilhada", "proximo": "info:*56|Acessar VM compartilhada|Ex: *56[numero]"},
                    {"texto": "*57 - Acessar Caixa Postal", "proximo": "info:*57|Acessa sua caixa postal"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "codigos_funcao"}
                ]
            },
            "monitoramento": {
                "mensagem": "C√≥digos de Monitoramento:",
                "opcoes": [
                    {"texto": "*63 - Monitoramento Silencioso", "proximo": "info:*63|Monitora a chamada|Ex: *63102"},
                    {"texto": "*97 - Captura Direta", "proximo": "info:*97|Atende a chamada de outro"},
                    {"texto": "*98 - Captura de Grupo", "proximo": "info:*98|Atende a chamadas de grupo"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "codigos_funcao"}
                ]
            },
            "nao_perturbe": {
                "mensagem": "C√≥digos N√£o Perturbe:",
                "opcoes": [
                    {"texto": "*78 - Ativar N√£o Perturbe", "proximo": "info:*78|Ativa N√£o Perturbe"},
                    {"texto": "*79 - Desativar N√£o Perturbe", "proximo": "info:*79|Desativa N√£o Perturbe"},
                    {"texto": "*77 - Rejeitar An√¥nimos", "proximo": "info:*77|Rejeita chamadas an√¥nimas"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "codigos_funcao"}
                ]
            },
            "chamada_rapida": {
                "mensagem": "C√≥digos de Discagem R√°pida:",
                "opcoes": [
                    {"texto": "*74 - Discagem R√°pida (1 d√≠gito)", "proximo": "info:*74|Configura atalho|Ex: *74512345"},
                    {"texto": "*75 - Discagem R√°pida (2 d√≠gitos)", "proximo": "info:*75|Configura atalho|Ex: *750612345678"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "codigos_funcao"}
                ]
            },
            "chamadas_anonimas": {
                "mensagem": "C√≥digos de Chamadas An√¥nimas:",
                "opcoes": [
                    {"texto": "*76 - Ativar An√¥nimo Sempre", "proximo": "info:*76|Chamadas sempre an√¥nimas"},
                    {"texto": "*52 - Ativar An√¥nimo por Chamada", "proximo": "info:*52|An√¥nimo por uma chamada|Ex: *5212345678"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "codigos_funcao"}
                ]
            },
            "ponte_richiamata": {
                "mensagem": "C√≥digos de Ponte/Retorno de Chamada:",
                "opcoes": [
                    {"texto": "*15 - Ponte de Chamada", "proximo": "info:*15|Junte-se a uma ponte"},
                    {"texto": "*33 - Retorno de Chamada Autom√°tico", "proximo": "info:*33|Avisa quando a linha estiver livre"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "codigos_funcao"}
                ]
            },
            "agentes_fila": {
                "mensagem": "C√≥digos para Agentes de Fila:",
                "opcoes": [
                    {"texto": "*36 - Status Pronto", "proximo": "info:*36|Agente pronto|Ex: *368000"},
                    {"texto": "*37 - Status N√£o Pronto", "proximo": "info:*37|Agente n√£o pronto|Ex: *378000"},
                    {"texto": "*38 - Entrar na Fila", "proximo": "info:*38|Acessa a fila|Ex: *388000"},
                    {"texto": "*39 - Sair da Fila", "proximo": "info:*39|Sai da fila|Ex: *398000"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "codigos_funcao"}
                ]
            },
            "hot_desking": {
                "mensagem": "C√≥digos de Hot Desking:",
                "opcoes": [
                    {"texto": "*70 - Login Hot Desking", "proximo": "info:*70|Acessa o dispositivo|Ex: *70100"},
                    {"texto": "*71 - Logout Hot Desking", "proximo": "info:*71|Sai do dispositivo"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "codigos_funcao"}
                ]
            },
            "outras_funcoes": {
                "mensagem": "Outros C√≥digos:",
                "opcoes": [
                    {"texto": "*69 - √öltima Chamada Recebida", "proximo": "info:*69|Retorna a √∫ltima chamada"},
                    {"texto": "*66 - Rediscar", "proximo": "info:*66|Redisca o √∫ltimo n√∫mero"},
                    {"texto": "*11 - Call Flip", "proximo": "info:*11|Transfere chamada entre dispositivos"},
                    {"texto": "*12 - Encerrar Chamadas", "proximo": "info:*12|Encerra todas as chamadas"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "codigos_funcao"}
                ]
            },
            "suporte": {
                "mensagem": "Suporte T√©cnico:",
                "opcoes": [
                    {"texto": "üîí Problemas de Login", "proximo": "suporte_login"},
                    {"texto": "üìû Problemas de Chamadas", "proximo": "suporte_chamadas"},
                    {"texto": "üë• Contatar Suporte", "proximo": "contato_suporte"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "menuInicial"}
                ]
            },
            "suporte_login": {
                "mensagem": "Problemas comuns de login:\n\n1. Verifique nome de usu√°rio e senha\n2. Verifique o dom√≠nio SIP e o endere√ßo do PABX\n3. Verifique a conex√£o com a internet\n4. Se usar QR Code, certifique-se de que √© v√°lido",
                "opcoes": [
                    {"texto": "‚ùì QR Code n√£o funciona", "proximo": "suporte_qr"},
                    {"texto": "üìû Chamar Suporte", "proximo": "contato_suporte"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "suporte"}
                ]
            },
            "suporte_qr": {
                "mensagem": "Problemas com QR Code:\n\n1. Gere um novo QR Code no PABX\n2. Certifique-se de que a c√¢mera funciona\n3. Verifique se o QR Code n√£o expirou\n4. Tente em um ambiente bem iluminado",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Ver Exemplo de QR Code", "proximo": "imagem:user_qr1.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "suporte_login"}
                ]
            },
            "suporte_chamadas": {
                "mensagem": "Problemas com as chamadas:\n\n1. Verifique a conex√£o com a internet\n2. Verifique se o microfone e o alto-falante funcionam\n3. Certifique-se de n√£o estar em modo avi√£o\n4. Verifique se o PABX est√° acess√≠vel",
                "opcoes": [
                    {"texto": "üìû Sem √°udio", "proximo": "suporte_audio"},
                    {"texto": "üìû Chamadas n√£o chegam", "proximo": "suporte_chamadas_entrantes"},
                    {"texto": "üìû Chamadas n√£o saem", "proximo": "suporte_chamadas_uscenti"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "suporte"}
                ]
            },
            "suporte_audio": {
                "mensagem": "Problemas de √°udio:\n\n1. Verifique se o app tem permiss√µes de microfone\n2. Tente com fones de ouvido diferentes\n3. Verifique o volume do dispositivo\n4. Reinicie o aplicativo",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Configura√ß√µes de √Åudio", "proximo": "imagem:portsip-one-mobile-33.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "suporte_chamadas"}
                ]
            },
            "suporte_chamadas_entrantes": {
                "mensagem": "Chamadas recebidas n√£o funcionando:\n\n1. Verifique o status da conta\n2. Verifique as regras de encaminhamento\n3. Certifique-se de n√£o estar em 'N√£o Perturbe'\n4. Verifique se a fila est√° ativa",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Status da Conta", "proximo": "imagem:portsip-one-mobile-34.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "suporte_chamadas"}
                ]
            },
            "suporte_chamadas_uscenti": {
                "mensagem": "Chamadas efetuadas n√£o funcionando:\n\n1. Verifique se o n√∫mero est√° correto\n2. Verifique as restri√ß√µes do PABX\n3. Certifique-se de ter cr√©dito (se aplic√°vel)\n4. Tente ligar para um n√∫mero interno",
                "opcoes": [
                    {"texto": "üëÅÔ∏è Exemplo: Chamada", "proximo": "imagem:portsip-one-mobile-35.png"},
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "suporte_chamadas"}
                ]
            },
            "contato_suporte": {
                "mensagem": "Contate nosso suporte:\n\nüìû 07366110\n‚úâÔ∏è support@meupabxcloud.com",
                "opcoes": [
                    {"texto": "‚Ü©Ô∏è Voltar", "proximo": "suporte"}
                ]
            }
        };

        // Estado do chat
        let currentConfig = { ...chatConfig };
        let currentMenu = "menuInicial";
        let chatHistory = [];
        let messageQueue = [];
        let isTyping = false;
        
        // Elementos DOM
        const chatMessages = document.getElementById('chat-messages');
        const optionsContainer = document.getElementById('options-container');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const configText = document.getElementById('config-text');
        const loadBtn = document.getElementById('load-btn');
        const configPanel = document.getElementById('config-panel');
        const togglePanelBtn = document.getElementById('toggle-panel-btn');
        
        // Fun√ß√µes
        function initChat() {
            // Verifica se deve ocultar o painel por padr√£o
            const urlParams = new URLSearchParams(window.location.search);
            const hidePanel = urlParams.get('hidePanel') !== 'true';
            
            if (hidePanel) {
                configPanel.classList.add('hidden');
                togglePanelBtn.classList.add('hidden');
            }
            
            showMenu(currentMenu);
            
            // Event listeners
            sendBtn.addEventListener('click', sendMessage);
            userInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendMessage();
            });
            
            loadBtn.addEventListener('click', loadConfig);
            togglePanelBtn.addEventListener('click', toggleConfigPanel);
            
            // Carrega configura√ß√£o padr√£o
            configText.value = JSON.stringify(chatConfig, null, 2);
        }
        
        function toggleConfigPanel() {
            configPanel.classList.toggle('hidden');
            togglePanelBtn.classList.toggle('hidden');
        }
        
        function loadConfig() {
            try {
                const config = JSON.parse(configText.value);
                currentConfig = config;
                currentMenu = Object.keys(currentConfig)[0];
                chatMessages.innerHTML = '';
                showMenu(currentMenu);
                addMessage("Configura√ß√£o carregada com sucesso!", 'bot');
            } catch (error) {
                addMessage("Erro ao carregar a configura√ß√£o: " + error.message, 'bot');
            }
        }
        
        function loadSampleConfig(type) {
            // Simula o carregamento de uma configura√ß√£o de exemplo
            addMessage(`Carregando configura√ß√£o ${type}...`, 'bot');
            setTimeout(() => {
                configText.value = JSON.stringify(chatConfig, null, 2);
                addMessage("Configura√ß√£o de exemplo carregada. Clique em 'Carregar Configura√ß√£o' para aplicar.", 'bot');
            }, 1000);
        }
        
        function showMenu(menuId) {
            const menu = currentConfig[menuId];
            if (!menu) {
                addMessage(`Menu "${menuId}" n√£o encontrado na configura√ß√£o.`, 'bot');
                return;
            }
            
            currentMenu = menuId;
            
            // Adiciona a mensagem do menu
            addMessage(menu.mensagem, 'bot', menuId);
            
            // Renderiza as op√ß√µes
            renderOptions(menu.opcoes);
        }
        
        function renderOptions(options) {
            optionsContainer.innerHTML = '';
            
            if (options && options.length > 0) {
                options.forEach(option => {
                    const button = document.createElement('button');
                    button.className = 'option-btn';
                    
                    if (option.icone) {
                        const icon = document.createElement('i');
                        icon.className = option.icone;
                        button.appendChild(icon);
                    }
                    
                    button.appendChild(document.createTextNode(option.texto));
                    button.onclick = () => {
                        addMessage(option.texto, 'user');
                        simulateTyping(() => {
                            handleOptionSelect(option.proximo);
                        });
                    };
                    optionsContainer.appendChild(button);
                });
            } else {
                // Se n√£o houver op√ß√µes, foca no campo de entrada
                userInput.focus();
            }
        }
        
        function handleOptionSelect(next) {
            if (next.startsWith("url:")) {
                // Abre URL externa
                const url = next.substring(4);
                window.open(url, '_blank');
            } 
            else if (next.startsWith("imagem:")) {
                // Mostra imagem
                const imageName = next.substring(7);
                showImagePlaceholder(imageName);
            } 
            else if (next.startsWith("info:")) {
                // Mostra informa√ß√£o de c√≥digo
                const parts = next.substring(5).split('|');
                showCodeInfo(parts[0], parts[1], parts[2]);
            }
            else {
                // Navega para outro menu
                showMenu(next);
            }
        }
        
        function showCodeInfo(code, description, example) {
            let message = `
                <div class="code-info">
                    <div class="code-header">${code}</div>
                    <div class="code-description">${description}</div>
            `;
            
            if (example) {
                message += `<div class="code-example">${example}</div>`;
            }
            
            message += `</div>`;
            
            // Bot√£o para voltar
            message += `<button class="back-btn" onclick="simulateTyping(() => { showMenu('${currentMenu}'); })">
                <i class="fas fa-arrow-left"></i> Voltar
            </button>`;
            
            // Limpa e mostra
            chatMessages.innerHTML = '';
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot-message';
            messageDiv.innerHTML = message;
            chatMessages.appendChild(messageDiv);
            
            // Limpa op√ß√µes
            optionsContainer.innerHTML = '';
        }
        
        function showImagePlaceholder(imageName) {
            const message = `
                <div class="image-container">
                    <div class="info-message">
                        <i class="fas fa-info-circle"></i> A imagem "${imageName}" seria exibida aqui
                    </div>
                    <button class="back-btn" onclick="simulateTyping(() => { showMenu('${currentMenu}'); })">
                        <i class="fas fa-arrow-left"></i> Voltar
                    </button>
                </div>
            `;
            
            // Limpa e mostra
            chatMessages.innerHTML = '';
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot-message';
            messageDiv.innerHTML = message;
            chatMessages.appendChild(messageDiv);
            
            // Limpa op√ß√µes
            optionsContainer.innerHTML = '';
        }
        
        function addMessage(text, sender, menuId = null) {
            // Se j√° estiver digitando, adiciona √† fila
            if (isTyping && sender === 'bot') {
                messageQueue.push({text, sender, menuId});
                return;
            }
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}-message`;
            
            // Adiciona texto com quebras de linha
            const lines = text.split('\n');
            lines.forEach((line, index) => {
                messageDiv.appendChild(document.createTextNode(line));
                if (index < lines.length - 1) {
                    messageDiv.appendChild(document.createElement('br'));
                }
            });
            
            // Adiciona o caminho do menu
            if (sender === 'bot' && menuId) {
                const pathDiv = document.createElement('div');
                pathDiv.className = 'menu-path';
                pathDiv.innerHTML = `<i class="fas fa-map-marker-alt"></i> ${menuId}`;
                messageDiv.appendChild(pathDiv);
            }
            
            chatMessages.appendChild(messageDiv);
            
            // Rola para a √∫ltima mensagem
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Salva no hist√≥rico
            chatHistory.push({
                sender,
                text,
                timestamp: new Date().toISOString(),
                menuId
            });
        }
        
        function simulateTyping(callback) {
            isTyping = true;
            
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.innerHTML = '<span></span><span></span><span></span>';
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Simula tempo de digita√ß√£o (1-3s)
            const typingTime = 1000 + Math.random() * 2000;
            
            setTimeout(() => {
                chatMessages.removeChild(typingDiv);
                isTyping = false;
                callback();
                
                // Processa mensagens na fila
                if (messageQueue.length > 0) {
                    const nextMessage = messageQueue.shift();
                    addMessage(nextMessage.text, nextMessage.sender, nextMessage.menuId);
                }
            }, typingTime);
        }
        
        function sendMessage() {
            const message = userInput.value.trim();
            if (!message) return;
            
            addMessage(message, 'user');
            userInput.value = '';
            
            // Resposta do bot para mensagens de texto livre
            simulateTyping(() => {
                addMessage("Entendi sua mensagem. Para uma melhor assist√™ncia, por favor, selecione uma das op√ß√µes do menu.", 'bot');
                showMenu(currentMenu);
            });
        }
        
        // Inicia o chat quando o DOM estiver pronto
        document.addEventListener('DOMContentLoaded', initChat);
        
        // Fun√ß√£o global para simular digita√ß√£o
        window.simulateTyping = simulateTyping;
    </script>
</body>
</html>
